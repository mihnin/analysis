"""
–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –º–æ–¥—É–ª—å —ç–∫—Å–ø–æ—Ä—Ç–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∞–Ω–∞–ª–∏–∑–∞ –≤ Excel –¥–ª—è desktop –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

–°–æ–∑–¥–∞–µ—Ç Excel —Ñ–∞–π–ª —Å 4+ –≤–∫–ª–∞–¥–∫–∞–º–∏:
1. –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ (–¥–∞–Ω–Ω—ã–µ + –º–µ—Ç—Ä–∏–∫–∏)
2. –ü—Ä–æ–≥–Ω–æ–∑ –∏ –∑–∞–∫—É–ø–∫–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏)
3. –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è (–∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è)
4. –≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π —ç—Ñ—Ñ–µ–∫—Ç (–ø–æ–ª—å–∑–∞ –¥–ª—è –±–∏–∑–Ω–µ—Å–∞)
"""

import pandas as pd
import xlsxwriter
from datetime import datetime
from typing import Optional


class ExcelExporter:
    """–ö–ª–∞—Å—Å –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Excel —Å —Ñ–∏—Ä–º–µ–Ω–Ω—ã–º –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ–º"""

    # –§–∏—Ä–º–µ–Ω–Ω—ã–µ —Ü–≤–µ—Ç–∞ –ù–æ—Ä–Ω–∏–∫–µ–ª—å –°–ø—É—Ç–Ω–∏–∫ (HEX -> RGB)
    COLOR_PRIMARY_BLUE = "#0077C8"
    COLOR_DARK_BLUE = "#004C97"
    COLOR_GRAY = "#626262"
    COLOR_LIGHT_GRAY = "#C8C8C8"
    COLOR_WHITE = "#FFFFFF"

    def __init__(self, file_path: str):
        """
        –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —ç–∫—Å–ø–æ—Ä—Ç–µ—Ä–∞.

        Args:
            file_path: –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
        """
        self.file_path = file_path
        self.workbook = xlsxwriter.Workbook(file_path)
        self._create_formats()

    def _create_formats(self):
        """–°–æ–∑–¥–∞—Ç—å —Ñ–æ—Ä–º–∞—Ç—ã —è—á–µ–µ–∫ –≤ —Ñ–∏—Ä–º–µ–Ω–Ω–æ–º —Å—Ç–∏–ª–µ"""
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–∞–±–ª–∏—Ü—ã
        self.format_header = self.workbook.add_format({
            'bold': True,
            'font_size': 12,
            'font_color': 'white',
            'bg_color': self.COLOR_DARK_BLUE,
            'align': 'center',
            'valign': 'vcenter',
            'border': 1,
            'text_wrap': True
        })

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        self.format_title = self.workbook.add_format({
            'bold': True,
            'font_size': 18,
            'font_color': self.COLOR_DARK_BLUE,
            'align': 'left',
            'valign': 'vcenter'
        })

        # –ü–æ–¥–∑–∞–≥–æ–ª–æ–≤–æ–∫
        self.format_subtitle = self.workbook.add_format({
            'bold': True,
            'font_size': 14,
            'font_color': self.COLOR_PRIMARY_BLUE,
            'align': 'left'
        })

        # –û–±—ã—á–Ω—ã–π —Ç–µ–∫—Å—Ç
        self.format_normal = self.workbook.add_format({
            'font_size': 11,
            'border': 1,
            'align': 'left',
            'valign': 'vcenter',
            'text_wrap': True
        })

        # –ß–∏—Å–ª–æ–≤–æ–π —Ñ–æ—Ä–º–∞—Ç
        self.format_number = self.workbook.add_format({
            'font_size': 11,
            'border': 1,
            'align': 'right',
            'num_format': '#,##0.00'
        })

        # –ü—Ä–æ—Ü–µ–Ω—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
        self.format_percent = self.workbook.add_format({
            'font_size': 11,
            'border': 1,
            'align': 'right',
            'num_format': '0.00%'
        })

        # –§–æ—Ä–º–∞—Ç –¥–∞—Ç—ã
        self.format_date = self.workbook.add_format({
            'font_size': 11,
            'border': 1,
            'align': 'center',
            'num_format': 'dd.mm.yyyy'
        })

        # –í—ã–¥–µ–ª–µ–Ω–Ω–∞—è —è—á–µ–π–∫–∞ (–≤–∞–∂–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)
        self.format_highlight = self.workbook.add_format({
            'bold': True,
            'font_size': 11,
            'font_color': self.COLOR_DARK_BLUE,
            'bg_color': '#E3F2FD',
            'border': 1,
            'align': 'right',
            'num_format': '#,##0.00'
        })

    def add_historical_analysis_sheet(self, df_results: pd.DataFrame, explanation: str):
        """
        –î–æ–±–∞–≤–∏—Ç—å –≤–∫–ª–∞–¥–∫—É —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.

        Args:
            df_results: DataFrame —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –∞–Ω–∞–ª–∏–∑–∞
            explanation: –¢–µ–∫—Å—Ç–æ–≤–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫
        """
        worksheet = self.workbook.add_worksheet('1. –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑')

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        worksheet.write('A1', '–ò–°–¢–û–†–ò–ß–ï–°–ö–ò–ô –ê–ù–ê–õ–ò–ó –ó–ê–ü–ê–°–û–í', self.format_title)
        worksheet.write('A2', f'–î–∞—Ç–∞ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è: {datetime.now().strftime("%d.%m.%Y %H:%M")}', self.format_normal)

        # –û–±—ä—è—Å–Ω–µ–Ω–∏–µ
        worksheet.write('A4', '–û–ë–™–Ø–°–ù–ï–ù–ò–ï –†–ê–°–ß–ï–¢–û–í:', self.format_subtitle)
        row = 5
        for line in explanation.split('\n'):
            if line.strip():
                worksheet.write(row, 0, line, self.format_normal)
                row += 1

        # –î–∞–Ω–Ω—ã–µ
        start_row = row + 2
        worksheet.write(start_row, 0, '–î–ê–ù–ù–´–ï:', self.format_subtitle)
        start_row += 1

        # –ó–∞–ø–∏—Å–∞—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏
        for col_num, column in enumerate(df_results.columns):
            worksheet.write(start_row, col_num, str(column), self.format_header)

        # –ó–∞–ø–∏—Å–∞—Ç—å –¥–∞–Ω–Ω—ã–µ
        for row_num, row_data in enumerate(df_results.values):
            for col_num, value in enumerate(row_data):
                # –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç —è—á–µ–π–∫–∏
                if pd.isna(value):
                    cell_format = self.format_normal
                elif isinstance(value, (int, float)):
                    cell_format = self.format_number
                elif isinstance(value, datetime):
                    cell_format = self.format_date
                else:
                    cell_format = self.format_normal

                worksheet.write(start_row + 1 + row_num, col_num, value, cell_format)

        # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —à–∏—Ä–∏–Ω—ã –∫–æ–ª–æ–Ω–æ–∫
        for col_num in range(len(df_results.columns)):
            worksheet.set_column(col_num, col_num, 15)

        # –ó–∞–º–æ—Ä–æ–∑–∏—Ç—å –ø–µ—Ä–≤—É—é —Å—Ç—Ä–æ–∫—É —Ç–∞–±–ª–∏—Ü—ã
        worksheet.freeze_panes(start_row + 1, 0)

    def add_forecast_analysis_sheet(self, df_results: pd.DataFrame, explanation: str):
        """
        –î–æ–±–∞–≤–∏—Ç—å –≤–∫–ª–∞–¥–∫—É —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –ø—Ä–æ–≥–Ω–æ–∑–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.

        Args:
            df_results: DataFrame —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –ø—Ä–æ–≥–Ω–æ–∑–∞
            explanation: –¢–µ–∫—Å—Ç–æ–≤–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ —Ä–∞—Å—á–µ—Ç–æ–≤
        """
        worksheet = self.workbook.add_worksheet('2. –ü—Ä–æ–≥–Ω–æ–∑ –∏ –∑–∞–∫—É–ø–∫–∏')

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        worksheet.write('A1', '–ü–†–û–ì–ù–û–ó –ó–ê–ü–ê–°–û–í –ò –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û –ó–ê–ö–£–ü–ö–ê–ú', self.format_title)
        worksheet.write('A2', f'–î–∞—Ç–∞ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è: {datetime.now().strftime("%d.%m.%Y %H:%M")}', self.format_normal)

        # –û–±—ä—è—Å–Ω–µ–Ω–∏–µ
        worksheet.write('A4', '–û–ë–™–Ø–°–ù–ï–ù–ò–ï –†–ê–°–ß–ï–¢–û–í:', self.format_subtitle)
        row = 5
        for line in explanation.split('\n'):
            if line.strip():
                worksheet.write(row, 0, line, self.format_normal)
                row += 1

        # –î–∞–Ω–Ω—ã–µ
        start_row = row + 2
        worksheet.write(start_row, 0, '–î–ê–ù–ù–´–ï:', self.format_subtitle)
        start_row += 1

        # –ó–∞–ø–∏—Å–∞—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏
        for col_num, column in enumerate(df_results.columns):
            worksheet.write(start_row, col_num, str(column), self.format_header)

        # –ó–∞–ø–∏—Å–∞—Ç—å –¥–∞–Ω–Ω—ã–µ
        for row_num, row_data in enumerate(df_results.values):
            for col_num, value in enumerate(row_data):
                # –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç —è—á–µ–π–∫–∏
                if pd.isna(value):
                    cell_format = self.format_normal
                elif isinstance(value, (int, float)):
                    # –í—ã–¥–µ–ª–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∑–∞–∫—É–ø–∫–∞–º
                    if col_num == len(df_results.columns) - 1:  # –ü–æ—Å–ª–µ–¥–Ω—è—è –∫–æ–ª–æ–Ω–∫–∞ - —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
                        cell_format = self.format_highlight
                    else:
                        cell_format = self.format_number
                elif isinstance(value, datetime):
                    cell_format = self.format_date
                else:
                    cell_format = self.format_normal

                worksheet.write(start_row + 1 + row_num, col_num, value, cell_format)

        # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —à–∏—Ä–∏–Ω—ã –∫–æ–ª–æ–Ω–æ–∫
        for col_num in range(len(df_results.columns)):
            worksheet.set_column(col_num, col_num, 15)

        # –ó–∞–º–æ—Ä–æ–∑–∏—Ç—å –ø–µ—Ä–≤—É—é —Å—Ç—Ä–æ–∫—É —Ç–∞–±–ª–∏—Ü—ã
        worksheet.freeze_panes(start_row + 1, 0)

    def add_instructions_sheet(self):
        """–î–æ–±–∞–≤–∏—Ç—å –≤–∫–ª–∞–¥–∫—É —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é"""
        worksheet = self.workbook.add_worksheet('3. –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è')

        row = 0

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        worksheet.write(row, 0, '–ò–ù–°–¢–†–£–ö–¶–ò–Ø –ü–û –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø', self.format_title)
        worksheet.set_row(row, 24)
        row += 2

        # –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        worksheet.write(row, 0, '–û –ü–†–ò–õ–û–ñ–ï–ù–ò–ò:', self.format_subtitle)
        row += 1
        worksheet.write(row, 0,
            '–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ "–ê–Ω–∞–ª–∏–∑ –∏ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø–∞—Å–æ–≤" –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–æ –¥–ª—è –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ '
            '–∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –æ–± –æ—Å—Ç–∞—Ç–∫–∞—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –ø–æ –∑–∞–∫—É–ø–∫–∞–º –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–æ–≥–Ω–æ–∑–æ–≤.',
            self.format_normal
        )
        row += 3

        # –®–∞–≥ 1
        worksheet.write(row, 0, '–®–ê–ì 1: –ü–û–î–ì–û–¢–û–í–ö–ê –î–ê–ù–ù–´–•', self.format_subtitle)
        row += 1

        instructions_step1 = [
            '1.1. –ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ —Ñ–∞–π–ª —Å –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ Excel (.xlsx –∏–ª–∏ .xls)',
            '',
            '–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏:',
            '  ‚Ä¢ –î–∞—Ç–∞ (—Ñ–æ—Ä–º–∞—Ç: –ì–ì–ì–ì-–ú–ú-–î–î –∏–ª–∏ –î–î.–ú–ú.–ì–ì–ì–ì)',
            '  ‚Ä¢ –ú–∞—Ç–µ—Ä–∏–∞–ª / –¢–æ–≤–∞—Ä / –ê—Ä—Ç–∏–∫—É–ª (—Ç–µ–∫—Å—Ç–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–ª–∏ –∫–æ–¥)',
            '  ‚Ä¢ –ù–∞—á–∞–ª—å–Ω—ã–π –æ—Å—Ç–∞—Ç–æ–∫ (—á–∏—Å–ª–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)',
            '  ‚Ä¢ –ö–æ–Ω–µ—á–Ω—ã–π –æ—Å—Ç–∞—Ç–æ–∫ (—á–∏—Å–ª–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)',
            '',
            '–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∫–æ–ª–æ–Ω–∫–∏:',
            '  ‚Ä¢ –§–∏–ª–∏–∞–ª / –°–∫–ª–∞–¥ / –ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ',
            '  ‚Ä¢ –ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ / –†–∞—Å—Ö–æ–¥ (–¥–ª—è –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞)',
            '  ‚Ä¢ –°—Ç–æ–∏–º–æ—Å—Ç—å –∫–æ–Ω–µ—á–Ω–æ–≥–æ –æ—Å—Ç–∞—Ç–∫–∞ (–¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ opportunity cost)',
            '',
            '1.2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã:',
            '  ‚Ä¢ –ù–µ—Ç –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ –∫–ª—é—á–µ–≤—ã—Ö –∫–æ–ª–æ–Ω–∫–∞—Ö',
            '  ‚Ä¢ –î–∞—Ç—ã —É–∫–∞–∑–∞–Ω—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ',
            '  ‚Ä¢ –ß–∏—Å–ª–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç —Ç–µ–∫—Å—Ç–∞',
        ]

        for line in instructions_step1:
            worksheet.write(row, 0, line, self.format_normal)
            row += 1

        row += 1

        # –®–∞–≥ 2
        worksheet.write(row, 0, '–®–ê–ì 2: –ó–ê–ì–†–£–ó–ö–ê –§–ê–ô–õ–ê –ò–°–¢–û–†–ò–ß–ï–°–ö–ò–• –î–ê–ù–ù–´–•', self.format_subtitle)
        row += 1

        instructions_step2 = [
            '2.1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ "–ê–Ω–∞–ª–∏–∑ –∏ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø–∞—Å–æ–≤.exe"',
            '2.2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–í—ã–±—Ä–∞—Ç—å Excel —Ñ–∞–π–ª" –≤ —Ä–∞–∑–¥–µ–ª–µ "–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ"',
            '2.3. –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–π —Ñ–∞–π–ª',
            '2.4. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç —Ñ–∞–π–ª –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —à–∞–±–ª–æ–Ω—É',
            '2.5. –ï—Å–ª–∏ —Ñ–∞–π–ª –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω, –≤—ã —É–≤–∏–¥–∏—Ç–µ –∑–µ–ª–µ–Ω—É—é –≥–∞–ª–æ—á–∫—É –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫/–∫–æ–ª–æ–Ω–æ–∫',
            '2.6. –ï—Å–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∏, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–∫–∞–∂–µ—Ç, –∫–∞–∫–∏–µ –∫–æ–ª–æ–Ω–∫–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç',
        ]

        for line in instructions_step2:
            worksheet.write(row, 0, line, self.format_normal)
            row += 1

        row += 1

        # –®–∞–≥ 3
        worksheet.write(row, 0, '–®–ê–ì 3: –í–´–ë–û–† –†–ï–ñ–ò–ú–ê –ü–†–û–ì–ù–û–ó–ò–†–û–í–ê–ù–ò–Ø', self.format_subtitle)
        row += 1

        instructions_step3 = [
            '–£ –≤–∞—Å –µ—Å—Ç—å –î–í–ê –≤–∞—Ä–∏–∞–Ω—Ç–∞ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è:',
            '',
            '–í–ê–†–ò–ê–ù–¢ A: –ó–∞–≥—Ä—É–∑–∏—Ç—å –≥–æ—Ç–æ–≤—ã–π –ø—Ä–æ–≥–Ω–æ–∑ —Å–ø—Ä–æ—Å–∞',
            '  3A.1. –ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ Excel —Ñ–∞–π–ª —Å –ø–ª–∞–Ω–æ–≤—ã–º —Å–ø—Ä–æ—Å–æ–º',
            '  3A.2. –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏: –î–∞—Ç–∞, –ú–∞—Ç–µ—Ä–∏–∞–ª, –ü–ª–∞–Ω–æ–≤—ã–π —Å–ø—Ä–æ—Å',
            '  3A.3. –ù–∞–∂–º–∏—Ç–µ "–í—ã–±—Ä–∞—Ç—å Excel —Ñ–∞–π–ª" –≤ —Ä–∞–∑–¥–µ–ª–µ "–ü—Ä–æ–≥–Ω–æ–∑–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ"',
            '',
            '–í–ê–†–ò–ê–ù–¢ B: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–æ–≥–Ω–æ–∑ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)',
            '  3B.1. –í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–æ–≥–Ω–æ–∑"',
            '  3B.2. –£–∫–∞–∂–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–µ—Ä–∏–æ–¥–æ–≤ –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∞ (1-24 –º–µ—Å—è—Ü–∞)',
            '  3B.3. –í—ã–±–µ—Ä–∏—Ç–µ –º–æ–¥–µ–ª—å –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –∏–ª–∏ –æ—Å—Ç–∞–≤—å—Ç–µ "AUTO" (—Å–∏—Å—Ç–µ–º–∞ –≤—ã–±–µ—Ä–µ—Ç –ª—É—á—à—É—é)',
            '  3B.4. –ú–æ–¥–µ–ª–∏: Naive, Moving Average, Exponential Smoothing, Holt-Winters, SARIMA',
        ]

        for line in instructions_step3:
            worksheet.write(row, 0, line, self.format_normal)
            row += 1

        row += 1

        # –®–∞–≥ 4
        worksheet.write(row, 0, '–®–ê–ì 4: –ù–ê–°–¢–†–û–ô–ö–ê –ü–ê–†–ê–ú–ï–¢–†–û–í (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)', self.format_subtitle)
        row += 1

        instructions_step4 = [
            '4.1. –ü—Ä–æ—Ü–µ–Ω—Ç —Å—Ç—Ä–∞—Ö–æ–≤–æ–≥–æ –∑–∞–ø–∞—Å–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 20%)',
            '  ‚Ä¢ –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ä–∞–∑–º–µ—Ä –±—É—Ñ–µ—Ä–Ω–æ–≥–æ –∑–∞–ø–∞—Å–∞ –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –¥–µ—Ñ–∏—Ü–∏—Ç–∞',
            '',
            '4.2. –ü—Ä–æ—Ü–µ–Ω—Ç–Ω–∞—è —Å—Ç–∞–≤–∫–∞ –¥–ª—è opportunity cost (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 5%)',
            '  ‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∑–∞–º–æ—Ä–æ–∂–µ–Ω–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ –≤ –∏–∑–±—ã—Ç–æ—á–Ω—ã—Ö –∑–∞–ø–∞—Å–∞—Ö',
            '',
            '4.3. –í—Ä–µ–º—è –ø–æ—Å—Ç–∞–≤–∫–∏ –¥–ª—è ROP (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 30 –¥–Ω–µ–π)',
            '  ‚Ä¢ –í–ª–∏—è–µ—Ç –Ω–∞ —Ä–∞—Å—á–µ—Ç —Ç–æ—á–∫–∏ –ø–µ—Ä–µ–∑–∞–∫–∞–∑–∞ (Reorder Point)',
        ]

        for line in instructions_step4:
            worksheet.write(row, 0, line, self.format_normal)
            row += 1

        row += 1

        # –®–∞–≥ 5
        worksheet.write(row, 0, '–®–ê–ì 5: –ó–ê–ü–£–°–ö –ê–ù–ê–õ–ò–ó–ê', self.format_subtitle)
        row += 1

        instructions_step5 = [
            '5.1. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "‚ñ∂ –í—ã–ø–æ–ª–Ω–∏—Ç—å –∞–Ω–∞–ª–∏–∑"',
            '5.2. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ (–æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä)',
            '5.3. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç:',
            '  ‚Ä¢ –ê–Ω–∞–ª–∏–∑ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö',
            '  ‚Ä¢ –ì–µ–Ω–µ—Ä–∞—Ü–∏—é –ø—Ä–æ–≥–Ω–æ–∑–∞ (–µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∂–∏–º)',
            '  ‚Ä¢ –†–∞—Å—á–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –ø–æ –∑–∞–∫—É–ø–∫–∞–º',
            '  ‚Ä¢ –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–∞',
        ]

        for line in instructions_step5:
            worksheet.write(row, 0, line, self.format_normal)
            row += 1

        row += 1

        # –®–∞–≥ 6
        worksheet.write(row, 0, '–®–ê–ì 6: –ü–†–û–°–ú–û–¢–† –ò –°–û–•–†–ê–ù–ï–ù–ò–ï –†–ï–ó–£–õ–¨–¢–ê–¢–û–í', self.format_subtitle)
        row += 1

        instructions_step6 = [
            '6.1. –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞–Ω–∞–ª–∏–∑–∞ –≤—ã —É–≤–∏–¥–∏—Ç–µ —Å–≤–æ–¥–∫—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤',
            '6.2. –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –∫–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ',
            '6.3. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ Excel"',
            '6.4. –í—ã–±–µ—Ä–∏—Ç–µ –º–µ—Å—Ç–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –∏–º—è —Ñ–∞–π–ª–∞',
            '6.5. Excel —Ñ–∞–π–ª –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å 4 –≤–∫–ª–∞–¥–∫–∏:',
            '  ‚Ä¢ –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ (–≤—Å–µ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏)',
            '  ‚Ä¢ –ü—Ä–æ–≥–Ω–æ–∑ –∏ –∑–∞–∫—É–ø–∫–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∑–∞–∫—É–ø–∫–∞–º)',
            '  ‚Ä¢ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è (—ç—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞)',
            '  ‚Ä¢ –≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π —ç—Ñ—Ñ–µ–∫—Ç (–ø–æ–ª—å–∑–∞ –¥–ª—è –±–∏–∑–Ω–µ—Å–∞)',
        ]

        for line in instructions_step6:
            worksheet.write(row, 0, line, self.format_normal)
            row += 1

        row += 2

        # –ü–æ–¥–¥–µ—Ä–∂–∫–∞
        worksheet.write(row, 0, '–¢–ï–•–ù–ò–ß–ï–°–ö–ê–Ø –ü–û–î–î–ï–†–ñ–ö–ê:', self.format_subtitle)
        row += 1
        worksheet.write(row, 0,
            '–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –≤–æ–ø—Ä–æ—Å–æ–≤ –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ —Å–ª—É–∂–±—É —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏ '
            '–ù–æ—Ä–Ω–∏–∫–µ–ª—å –°–ø—É—Ç–Ω–∏–∫.',
            self.format_normal
        )

        # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —à–∏—Ä–∏–Ω—ã –∫–æ–ª–æ–Ω–æ–∫
        worksheet.set_column(0, 0, 100)

    def add_business_value_sheet(self):
        """–î–æ–±–∞–≤–∏—Ç—å –≤–∫–ª–∞–¥–∫—É —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞"""
        worksheet = self.workbook.add_worksheet('4. –≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π —ç—Ñ—Ñ–µ–∫—Ç')

        row = 0

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        worksheet.write(row, 0, '–≠–ö–û–ù–û–ú–ò–ß–ï–°–ö–ò–ô –≠–§–§–ï–ö–¢ –ò –ü–û–õ–¨–ó–ê –î–õ–Ø –ë–ò–ó–ù–ï–°–ê', self.format_title)
        worksheet.set_row(row, 24)
        row += 2

        # –í–≤–µ–¥–µ–Ω–∏–µ
        worksheet.write(row, 0,
            '–í–Ω–µ–¥—Ä–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –∞–Ω–∞–ª–∏–∑–∞ –∏ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø–∞—Å–æ–≤ –ø—Ä–∏–Ω–æ—Å–∏—Ç —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–π '
            '—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π —ç—Ñ—Ñ–µ–∫—Ç –∑–∞ —Å—á–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏.',
            self.format_normal
        )
        row += 3

        # –í—ã–≥–æ–¥–∞ 1
        worksheet.write(row, 0, '1. –°–ù–ò–ñ–ï–ù–ò–ï –ó–ê–¢–†–ê–¢ –ù–ê –•–†–ê–ù–ï–ù–ò–ï', self.format_subtitle)
        row += 1

        benefits_1 = [
            '–ü–†–û–ë–õ–ï–ú–ê:',
            '–ò–∑–±—ã—Ç–æ—á–Ω—ã–µ –∑–∞–ø–∞—Å—ã –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –∑–∞–Ω–∏–º–∞—é—Ç —Å–∫–ª–∞–¥—Å–∫–∏–µ –ø–ª–æ—â–∞–¥–∏ –∏ –∑–∞–º–æ—Ä–∞–∂–∏–≤–∞—é—Ç –æ–±–æ—Ä–æ—Ç–Ω—ã–π –∫–∞–ø–∏—Ç–∞–ª.',
            '',
            '–†–ï–®–ï–ù–ò–ï:',
            '–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤—ã—è–≤–ª—è–µ—Ç –∏–∑–ª–∏—à–∫–∏ –∏ –º–µ—Ä—Ç–≤—ã–π –∑–∞–ø–∞—Å (dead stock), —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç opportunity cost - '
            '—Å—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–º–æ—Ä–æ–∂–µ–Ω–Ω—ã—Ö –≤ –∑–∞–ø–∞—Å–∞—Ö —Å—Ä–µ–¥—Å—Ç–≤.',
            '',
            '–≠–ö–û–ù–û–ú–ò–ß–ï–°–ö–ò–ô –≠–§–§–ï–ö–¢:',
            '‚Ä¢ –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ –∏–∑–±—ã—Ç–æ—á–Ω—ã—Ö –∑–∞–ø–∞—Å–æ–≤ –Ω–∞ 15-25%',
            '‚Ä¢ –í—ã—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –æ–±–æ—Ä–æ—Ç–Ω–æ–≥–æ –∫–∞–ø–∏—Ç–∞–ª–∞',
            '‚Ä¢ –°–Ω–∏–∂–µ–Ω–∏–µ –∑–∞—Ç—Ä–∞—Ç –Ω–∞ –∞—Ä–µ–Ω–¥—É —Å–∫–ª–∞–¥—Å–∫–∏—Ö –ø–ª–æ—â–∞–¥–µ–π',
            '‚Ä¢ –£–º–µ–Ω—å—à–µ–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥–æ–≤ –Ω–∞ –ª–æ–≥–∏—Å—Ç–∏–∫—É –∏ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —Å–∫–ª–∞–¥–∞',
            '',
            '–ü–†–ò–ú–ï–†:',
            '–ï—Å–ª–∏ –∏–∑–±—ã—Ç–æ—á–Ω—ã–µ –∑–∞–ø–∞—Å—ã —Å–æ—Å—Ç–∞–≤–ª—è—é—Ç 10 –º–ª–Ω —Ä—É–±. –ø—Ä–∏ —Å—Ç–∞–≤–∫–µ 5% –≥–æ–¥–æ–≤—ã—Ö, '
            'opportunity cost = 500 —Ç—ã—Å. —Ä—É–±./–≥–æ–¥. –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ –∑–∞–ø–∞—Å–æ–≤ –Ω–∞ 20% —ç–∫–æ–Ω–æ–º–∏—Ç 100 —Ç—ã—Å. —Ä—É–±./–≥–æ–¥.',
        ]

        for line in benefits_1:
            worksheet.write(row, 0, line, self.format_normal)
            row += 1

        row += 2

        # –í—ã–≥–æ–¥–∞ 2
        worksheet.write(row, 0, '2. –£–ú–ï–ù–¨–®–ï–ù–ò–ï –î–ï–§–ò–¶–ò–¢–ê –ò –ü–†–û–°–¢–û–ï–í', self.format_subtitle)
        row += 1

        benefits_2 = [
            '–ü–†–û–ë–õ–ï–ú–ê:',
            '–î–µ—Ñ–∏—Ü–∏—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –ø—Ä–æ—Å—Ç–æ—è–º –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞, —Å—Ä—ã–≤–∞–º —Å—Ä–æ–∫–æ–≤, '
            '–ø–æ—Ç–µ—Ä–µ –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ —É–ø—É—â–µ–Ω–Ω–æ–π –≤—ã–≥–æ–¥–µ.',
            '',
            '–†–ï–®–ï–ù–ò–ï:',
            '–°–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –¥–µ—Ñ–∏—Ü–∏—Ç–æ–≤, —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç Fill Rate (—É—Ä–æ–≤–µ–Ω—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤), '
            '–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–æ—á–∫—É –ø–µ—Ä–µ–∑–∞–∫–∞–∑–∞ (ROP) –∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç —Å—Ç—Ä–∞—Ö–æ–≤—ã–µ –∑–∞–ø–∞—Å—ã.',
            '',
            '–≠–ö–û–ù–û–ú–ò–ß–ï–°–ö–ò–ô –≠–§–§–ï–ö–¢:',
            '‚Ä¢ –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ —Å–ª—É—á–∞–µ–≤ –¥–µ—Ñ–∏—Ü–∏—Ç–∞ –Ω–∞ 30-40%',
            '‚Ä¢ –°–Ω–∏–∂–µ–Ω–∏–µ –ø—Ä–æ—Å—Ç–æ–µ–≤ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞',
            '‚Ä¢ –ü–æ–≤—ã—à–µ–Ω–∏–µ Fill Rate –¥–æ 95-98%',
            '‚Ä¢ –£–ª—É—á—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤',
            '‚Ä¢ –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ —à—Ç—Ä–∞—Ñ–æ–≤ –∑–∞ —Å—Ä—ã–≤ —Å—Ä–æ–∫–æ–≤ –ø–æ—Å—Ç–∞–≤–æ–∫',
            '',
            '–ü–†–ò–ú–ï–†:',
            '–ï—Å–ª–∏ –æ–¥–∏–Ω –¥–µ–Ω—å –ø—Ä–æ—Å—Ç–æ—è –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–π –ª–∏–Ω–∏–∏ —Å—Ç–æ–∏—Ç 1 –º–ª–Ω —Ä—É–±., –∞ –¥–µ—Ñ–∏—Ü–∏—Ç—ã —Å–æ–∫—Ä–∞—â–∞—é—Ç—Å—è '
            '—Å 12 –¥–æ 5 —Å–ª—É—á–∞–µ–≤ –≤ –≥–æ–¥, —ç–∫–æ–Ω–æ–º–∏—è —Å–æ—Å—Ç–∞–≤–∏—Ç 7 –º–ª–Ω —Ä—É–±./–≥–æ–¥.',
        ]

        for line in benefits_2:
            worksheet.write(row, 0, line, self.format_normal)
            row += 1

        row += 2

        # –í—ã–≥–æ–¥–∞ 3
        worksheet.write(row, 0, '3. –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø –ó–ê–ö–£–ü–û–ö', self.format_subtitle)
        row += 1

        benefits_3 = [
            '–ü–†–û–ë–õ–ï–ú–ê:',
            '–ù–µ–æ–±–æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–µ –∏–ª–∏ –Ω–µ—Å–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–∫—É–ø–∫–∏ –ø—Ä–∏–≤–æ–¥—è—Ç –∫ –ø–µ—Ä–µ–ø–ª–∞—Ç–∞–º, —Å—Ä–æ—á–Ω—ã–º –∑–∞–∫–∞–∑–∞–º '
            '–ø–æ –∑–∞–≤—ã—à–µ–Ω–Ω—ã–º —Ü–µ–Ω–∞–º, –ø–æ—Ç–µ—Ä—è–º –Ω–∞ —Ö—Ä–∞–Ω–µ–Ω–∏–∏ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤.',
            '',
            '–†–ï–®–ï–ù–ò–ï:',
            '–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç —Ç–æ—á–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ–±—ä–µ–º–∞–º –∏ —Å—Ä–æ–∫–∞–º –∑–∞–∫—É–ø–æ–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–æ–≥–Ω–æ–∑–æ–≤ —Å–ø—Ä–æ—Å–∞, '
            '—É—á–∏—Ç—ã–≤–∞—è —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç—å, —Ç—Ä–µ–Ω–¥—ã, —Å—Ç—Ä–∞—Ö–æ–≤—ã–µ –∑–∞–ø–∞—Å—ã –∏ –≤—Ä–µ–º—è –ø–æ—Å—Ç–∞–≤–∫–∏.',
            '',
            '–≠–ö–û–ù–û–ú–ò–ß–ï–°–ö–ò–ô –≠–§–§–ï–ö–¢:',
            '‚Ä¢ –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ —Å—Ä–æ—á–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ 50-70%',
            '‚Ä¢ –°–Ω–∏–∂–µ–Ω–∏–µ –∑–∞–∫—É–ø–æ—á–Ω—ã—Ö —Ü–µ–Ω –∑–∞ —Å—á–µ—Ç –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è',
            '‚Ä¢ –£–º–µ–Ω—å—à–µ–Ω–∏–µ –∑–∞—Ç—Ä–∞—Ç –Ω–∞ —ç–∫—Å–ø—Ä–µ—Å—Å-–¥–æ—Å—Ç–∞–≤–∫—É',
            '‚Ä¢ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –æ–±–æ—Ä–∞—á–∏–≤–∞–µ–º–æ—Å—Ç–∏ –∑–∞–ø–∞—Å–æ–≤',
            '‚Ä¢ –£–ª—É—á—à–µ–Ω–∏–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–π —Å –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞–º–∏',
            '',
            '–ü–†–ò–ú–ï–†:',
            '–ï—Å–ª–∏ –æ–±—ä–µ–º –∑–∞–∫—É–ø–æ–∫ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 100 –º–ª–Ω —Ä—É–±./–≥–æ–¥, –∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–Ω–∏–∂–∞–µ—Ç —Ü–µ–Ω—ã –Ω–∞ 3% –∏ '
            '—É—Å—Ç—Ä–∞–Ω—è–µ—Ç 20 —Å—Ä–æ—á–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤ (–¥–æ–ø. —Å—Ç–æ–∏–º–æ—Å—Ç—å 100 —Ç—ã—Å. —Ä—É–±./–∑–∞–∫–∞–∑), '
            '—ç–∫–æ–Ω–æ–º–∏—è = 3 –º–ª–Ω + 2 –º–ª–Ω = 5 –º–ª–Ω —Ä—É–±./–≥–æ–¥.',
        ]

        for line in benefits_3:
            worksheet.write(row, 0, line, self.format_normal)
            row += 1

        row += 2

        # –í—ã–≥–æ–¥–∞ 4
        worksheet.write(row, 0, '4. –ü–û–í–´–®–ï–ù–ò–ï –¢–û–ß–ù–û–°–¢–ò –ü–õ–ê–ù–ò–†–û–í–ê–ù–ò–Ø', self.format_subtitle)
        row += 1

        benefits_4 = [
            '–ü–†–û–ë–õ–ï–ú–ê:',
            '–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –Ω–∞–¥–µ–∂–Ω—ã—Ö –ø—Ä–æ–≥–Ω–æ–∑–æ–≤ —É—Å–ª–æ–∂–Ω—è–µ—Ç –±—é–¥–∂–µ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ '
            '–∏ –ø—Ä–∏–Ω—è—Ç–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏—Ö —Ä–µ—à–µ–Ω–∏–π.',
            '',
            '–†–ï–®–ï–ù–ò–ï:',
            '–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç 5 –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è (Naive, MA, ES, Holt-Winters, SARIMA), '
            '–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ—Ç –ª—É—á—à—É—é –º–æ–¥–µ–ª—å, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ —Ç–æ—á–Ω–æ—Å—Ç–∏ (MAPE, MAE, RMSE).',
            '',
            '–≠–ö–û–ù–û–ú–ò–ß–ï–°–ö–ò–ô –≠–§–§–ï–ö–¢:',
            '‚Ä¢ –ü–æ–≤—ã—à–µ–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏ –ø—Ä–æ–≥–Ω–æ–∑–æ–≤ –Ω–∞ 20-30%',
            '‚Ä¢ –£–ª—É—á—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –±—é–¥–∂–µ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è',
            '‚Ä¢ –°–Ω–∏–∂–µ–Ω–∏–µ —Ä–∏—Å–∫–æ–≤ –ø—Ä–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞',
            '‚Ä¢ –ë–æ–ª–µ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–µ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è',
            '',
            '–ü–†–ò–ú–ï–†:',
            '–¢–æ—á–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å –∑–∞–∫—É–ø–∫–∏ –∏–∑–±—ã—Ç–æ—á–Ω–æ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –Ω–∞ 15 –º–ª–Ω —Ä—É–±. '
            '–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –≤ —Å–∫–ª–∞–¥—Å–∫—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É, —ç–∫–æ–Ω–æ–º—è 5 –º–ª–Ω —Ä—É–±.',
        ]

        for line in benefits_4:
            worksheet.write(row, 0, line, self.format_normal)
            row += 1

        row += 2

        # –í—ã–≥–æ–¥–∞ 5
        worksheet.write(row, 0, '5. –ê–í–¢–û–ú–ê–¢–ò–ó–ê–¶–ò–Ø –ò –≠–ö–û–ù–û–ú–ò–Ø –í–†–ï–ú–ï–ù–ò', self.format_subtitle)
        row += 1

        benefits_5 = [
            '–ü–†–û–ë–õ–ï–ú–ê:',
            '–†—É—á–Ω–æ–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –≤ Excel –∑–∞–Ω–∏–º–∞–µ—Ç –¥–µ—Å—è—Ç–∫–∏ —á–∞—Å–æ–≤ —Ä–∞–±–æ—á–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤, '
            '–ø–æ–¥–≤–µ—Ä–∂–µ–Ω –æ—à–∏–±–∫–∞–º, –Ω–µ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è.',
            '',
            '–†–ï–®–ï–ù–ò–ï:',
            '–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç—ã—Å—è—á–∏ —Å—Ç—Ä–æ–∫ –¥–∞–Ω–Ω—ã—Ö –∑–∞ —Å–µ–∫—É–Ω–¥—ã, '
            '—Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –¥–µ—Å—è—Ç–∫–∏ –º–µ—Ç—Ä–∏–∫, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø–æ–Ω—è—Ç–Ω—ã–µ –æ—Ç—á–µ—Ç—ã —Å –æ–±—ä—è—Å–Ω–µ–Ω–∏—è–º–∏.',
            '',
            '–≠–ö–û–ù–û–ú–ò–ß–ï–°–ö–ò–ô –≠–§–§–ï–ö–¢:',
            '‚Ä¢ –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –∞–Ω–∞–ª–∏–∑ —Å 20-30 —á–∞—Å–æ–≤ –¥–æ 10 –º–∏–Ω—É—Ç',
            '‚Ä¢ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ —á–µ–ª–æ–≤–µ—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ –≤ —Ä–∞—Å—á–µ—Ç–∞—Ö',
            '‚Ä¢ –í—ã—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤ –¥–ª—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á',
            '‚Ä¢ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∞–Ω–∞–ª–∏–∑–∞ –±–æ–ª—å—à–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤',
            '',
            '–ü–†–ò–ú–ï–†:',
            '–ï—Å–ª–∏ –∞–Ω–∞–ª–∏—Ç–∏–∫ —Ç—Ä–∞—Ç–∏—Ç 25 —á–∞—Å–æ–≤/–º–µ—Å—è—Ü –Ω–∞ –∞–Ω–∞–ª–∏–∑ –∑–∞–ø–∞—Å–æ–≤ –ø—Ä–∏ —Å—Ç–∞–≤–∫–µ 3000 —Ä—É–±./—á–∞—Å, '
            '—ç–∫–æ–Ω–æ–º–∏—è –≤—Ä–µ–º–µ–Ω–∏ 90% = 22.5 —á–∞—Å–∞/–º–µ—Å—è—Ü = 67.5 —Ç—ã—Å. —Ä—É–±./–º–µ—Å—è—Ü = 810 —Ç—ã—Å. —Ä—É–±./–≥–æ–¥.',
        ]

        for line in benefits_5:
            worksheet.write(row, 0, line, self.format_normal)
            row += 1

        row += 3

        # –ò—Ç–æ–≥–æ
        worksheet.write(row, 0, '–ò–¢–û–ì–û–í–´–ô –≠–ö–û–ù–û–ú–ò–ß–ï–°–ö–ò–ô –≠–§–§–ï–ö–¢:', self.format_subtitle)
        row += 1

        summary = [
            '–°–æ–≤–æ–∫—É–ø–Ω—ã–π –≥–æ–¥–æ–≤–æ–π —ç—Ñ—Ñ–µ–∫—Ç –æ—Ç –≤–Ω–µ–¥—Ä–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã (–Ω–∞ –ø—Ä–∏–º–µ—Ä–µ —Å—Ä–µ–¥–Ω–µ–≥–æ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è):',
            '',
            '1. –°–Ω–∏–∂–µ–Ω–∏–µ –∑–∞—Ç—Ä–∞—Ç –Ω–∞ —Ö—Ä–∞–Ω–µ–Ω–∏–µ:          +2,000,000 —Ä—É–±.',
            '2. –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ –ø—Ä–æ—Å—Ç–æ–µ–≤ –æ—Ç –¥–µ—Ñ–∏—Ü–∏—Ç–∞:      +7,000,000 —Ä—É–±.',
            '3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–∫—É–ø–æ–∫:                  +5,000,000 —Ä—É–±.',
            '4. –£–ª—É—á—à–µ–Ω–∏–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è:               +3,000,000 —Ä—É–±.',
            '5. –≠–∫–æ–Ω–æ–º–∏—è –≤—Ä–µ–º–µ–Ω–∏ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤:          +810,000 —Ä—É–±.',
            '‚îÄ' * 60,
            '–ò–¢–û–ì–û –≠–§–§–ï–ö–¢ –í –ì–û–î:                     +17,810,000 —Ä—É–±.',
            '',
            'ROI (–æ–∫—É–ø–∞–µ–º–æ—Å—Ç—å –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π): –º–µ–Ω–µ–µ 1 –º–µ—Å—è—Ü–∞',
            '',
            '–í–Ω–µ–¥—Ä–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –∞–Ω–∞–ª–∏–∑–∞ –∏ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø–∞—Å–æ–≤ - —ç—Ç–æ –Ω–µ –∑–∞—Ç—Ä–∞—Ç—ã, '
            '–∞ –≤—ã—Å–æ–∫–æ–¥–æ—Ö–æ–¥–Ω–∞—è –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏—è –≤ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –±–∏–∑–Ω–µ—Å–∞.',
        ]

        for line in summary:
            if '–ò–¢–û–ì–û –≠–§–§–ï–ö–¢' in line:
                worksheet.write(row, 0, line, self.format_highlight)
            else:
                worksheet.write(row, 0, line, self.format_normal)
            row += 1

        # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —à–∏—Ä–∏–Ω—ã –∫–æ–ª–æ–Ω–æ–∫
        worksheet.set_column(0, 0, 100)

    def close(self):
        """–ó–∞–∫—Ä—ã—Ç—å –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ–∞–π–ª"""
        try:
            self.workbook.close()
            return True
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞: {e}")
            return False


def export_full_report(
    file_path: str,
    df_historical: Optional[pd.DataFrame] = None,
    explanation_historical: Optional[str] = None,
    df_forecast: Optional[pd.DataFrame] = None,
    explanation_forecast: Optional[str] = None
) -> bool:
    """
    –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç –≤ Excel.

    Args:
        file_path: –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
        df_historical: DataFrame —Å –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–º –∞–Ω–∞–ª–∏–∑–æ–º
        explanation_historical: –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
        df_forecast: DataFrame —Å –ø—Ä–æ–≥–Ω–æ–∑–æ–º
        explanation_forecast: –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥–Ω–æ–∑–∞

    Returns:
        bool: True –µ—Å–ª–∏ —É—Å–ø–µ—à–Ω–æ, False –µ—Å–ª–∏ –æ—à–∏–±–∫–∞
    """
    try:
        exporter = ExcelExporter(file_path)

        # –î–æ–±–∞–≤–∏—Ç—å –≤–∫–ª–∞–¥–∫–∏
        if df_historical is not None and explanation_historical:
            exporter.add_historical_analysis_sheet(df_historical, explanation_historical)

        if df_forecast is not None and explanation_forecast:
            exporter.add_forecast_analysis_sheet(df_forecast, explanation_forecast)

        exporter.add_instructions_sheet()
        exporter.add_business_value_sheet()

        # –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ–∞–π–ª
        return exporter.close()

    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ: {e}")
        return False
