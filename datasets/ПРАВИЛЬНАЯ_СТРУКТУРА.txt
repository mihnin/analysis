================================================================================
ПРАВИЛЬНАЯ СТРУКТУРА ДАННЫХ (обновлено 2025-10-19)
================================================================================

✓ Создан новый шаблон с ЛОГИЧНОЙ и ПОЛНОЙ структурой!

Файл: historical_data_correct_template.xlsx


================================================================================
СТРУКТУРА ФАЙЛА (9 колонок)
================================================================================

1. Дата
   - Формат: Дата (ГГГГ-ММ-ДД)
   - Пример: 2023-01-31

2. Филиал
   - Формат: Текст
   - Пример: Москва

3. Материал
   - Формат: Текст
   - Пример: Материал A

4. Начальный остаток
   - Формат: Число (количество на начало периода)
   - Пример: 500

5. Поступление  ← НОВОЕ!
   - Формат: Число (количество поступивших материалов)
   - Пример: 300
   - Зачем: Чтобы видеть, сколько материала поступило

6. Потребление
   - Формат: Число (количество израсходованных материалов)
   - Пример: 200

7. Конечный остаток  ← РАСЧИТЫВАЕТСЯ!
   - Формат: Число (количество на конец периода)
   - Пример: 600
   - Формула: Начальный остаток + Поступление - Потребление

8. Цена за единицу  ← НОВОЕ!
   - Формат: Число (цена за 1 единицу материала)
   - Пример: 50.00
   - Зачем: Базовый показатель стоимости

9. Конечная стоимость  ← РАСЧИТЫВАЕТСЯ!
   - Формат: Число (стоимость остатков на конец периода)
   - Пример: 30000
   - Формула: Конечный остаток * Цена за единицу


================================================================================
БАЛАНСОВОЕ УРАВНЕНИЕ
================================================================================

  Конечный остаток = Начальный остаток + Поступление - Потребление

Пример:
  Начальный остаток: 500
  Поступление:      +300
  Потребление:      -200
  ─────────────────────
  Конечный остаток:  600


================================================================================
РАСЧЕТ СТОИМОСТИ
================================================================================

  Конечная стоимость = Конечный остаток * Цена за единицу

Пример:
  Конечный остаток:  600
  Цена за единицу:    50
  ──────────────────────
  Конечная стоимость: 30,000


================================================================================
ПРИМЕР ДАННЫХ
================================================================================

Дата       | Филиал | Материал   | Нач. ост | Поступ | Потреб | Кон. ост | Цена | Кон. стоим
-----------|--------|------------|----------|--------|--------|----------|------|------------
2023-01-31 | Москва | Материал A |   500    |  300   |  200   |   600    | 50.0 |  30000.00
2023-02-28 | Москва | Материал A |   600    |    0   |  150   |   450    | 50.5 |  22725.00
2023-03-31 | Москва | Материал A |   450    |  400   |  180   |   670    | 51.0 |  34170.00

Проверка балансового уравнения:
  Строка 1: 500 + 300 - 200 = 600 ✓
  Строка 2: 600 +   0 - 150 = 450 ✓
  Строка 3: 450 + 400 - 180 = 670 ✓


================================================================================
ПРЕИМУЩЕСТВА ЭТОЙ СТРУКТУРЫ
================================================================================

✓ Полная картина движения материалов
  - Видно, сколько было на начало
  - Видно, сколько поступило
  - Видно, сколько израсходовано
  - Видно, сколько осталось

✓ Балансовое уравнение всегда сходится
  - Легко проверить корректность данных
  - Нач.ост + Поступ - Потреб = Кон.ост

✓ Прозрачный расчет стоимости
  - Цена за единицу - базовый показатель
  - Конечная стоимость = автоматический расчет
  - Можно отслеживать динамику цен

✓ Больше возможностей для анализа
  - Анализ поставок
  - Анализ динамики цен
  - Более точное планирование закупок


================================================================================
ЧЕМ ЛУЧШЕ ПРЕДЫДУЩЕЙ ВЕРСИИ?
================================================================================

Старая структура (7 колонок):
  Дата | Филиал | Материал | Нач.ост | Кон.ост | Потребление | Кон.стоимость

  Проблемы:
    ✗ Не видно поступления материалов
    ✗ Конечная стоимость - это итоговый показатель, а не базовый
    ✗ Балансовое уравнение не прозрачно

Новая структура (9 колонок):
  Дата | Филиал | Материал | Нач.ост | Поступ | Потреб | Кон.ост | Цена | Кон.стоим

  Преимущества:
    ✓ Видно все движения материалов
    ✓ Цена за единицу - базовый показатель
    ✓ Балансовое уравнение очевидно
    ✓ Больше аналитики


================================================================================
КАК ИСПОЛЬЗОВАТЬ ЭТОТ ШАБЛОН
================================================================================

1. Откройте файл:
   c:\dev\analysis\datasets\historical_data_correct_template.xlsx

2. Замените данные своими (сохраните структуру!)

3. Убедитесь, что соблюдается балансовое уравнение:
   Конечный остаток = Начальный остаток + Поступление - Потребление

4. Убедитесь, что стоимость рассчитывается правильно:
   Конечная стоимость = Конечный остаток * Цена за единицу

5. Загрузите в приложение!


================================================================================
ПРИМЕЧАНИЕ
================================================================================

Старый шаблон (historical_data_template.xlsx) по-прежнему работает!

Но новый шаблон (historical_data_correct_template.xlsx) более логичный
и дает больше возможностей для анализа.

Выбирайте тот, который вам удобнее!


================================================================================
НА ОРБИТЕ ДОВЕРИЯ
© 2025 Норникель Спутник
================================================================================
